#!/data/data/com.termux/files/usr/bin/bash

# ==================================================
#                 #TitoVPN Free ๐
# ==================================================
# ๐น Bot de Telegram: @InternetTitofree_bot
# ๐น CANAL OFICIAL: https://t.me/titoYTMex
# ๐น CHAT OFICIAL:  https://t.me/titoYTMex2
# ๐น FACEBOOK:
# https://www.facebook.com/profile.php?id=61552016896249&mibextid=ZbWKwL
#
# ๐ UNANSE A TODOS PARA QUE SIEMPRE ESTEN INFORMADOS
# ๐ DIOS LES BENDIGA
# ==================================================


# ---------- CONFIGURACIรN ----------
WAIT_TIME=300
LOG_FILE="slipstream.log"
LAST_DNS="last_dns.txt"
SCRIPT_NAME="tito_vpn"  # Nombre del BINARIO
GITHUB_RAW_URL="https://raw.githubusercontent.com/TitoYTMex23/tito_vpn_bin/main/tito_vpn"  # URL del BINARIO
VERSION="1.0.0"  # Versiรณn actual
VERSION_FILE="tito_vpn_version.txt"
UPDATE_CHECK_INTERVAL=86400  # 24 hora en segundos
LAST_CHECK_FILE="last_update_check.txt"

# ---------- DNS ORIGINALES (INTACTOS) ----------
DNS_MOBILE=(
  "200.55.128.250"
  "200.55.128.230"
  "200.55.128.140"
  "200.55.128.130"
)

DNS_WIFI=(
  "181.225.231.120"
  "181.225.231.110"
  "181.225.233.40"
  "181.225.233.30"
)

# ---------- CONFIGURACIONES PREMIUM ----------
THEME="tech"  # tech, gaming, minimal, cyber, matrix
INSTALL_MODE="guided"  # guided, auto, expert
SOUND_ENABLED=true
ANIMATIONS_ENABLED=true
HELP_ENABLED=true

# ---------- COLORES ORIGINALES (MANTENIDOS) ----------
NC="\e[0m"
BOLD="\e[1m"
GREEN="\e[32m"
RED="\e[31m"
YELLOW="\e[33m"
BLUE="\e[34m"
CYAN="\e[36m"
MAGENTA="\e[35m"

# ---------- COLORES DINรMICOS PREMIUM ----------
load_colors() {
    case $THEME in
        "tech")
            R="\e[1;31m"    # Rojo brillante
            G="\e[1;32m"    # Verde brillante
            Y="\e[1;33m"    # Amarillo brillante
            B="\e[1;34m"    # Azul brillante
            M="\e[1;35m"    # Magenta brillante
            C="\e[1;36m"    # Cyan brillante
            W="\e[1;37m"    # Blanco brillante
            P="\e[1;35m"    # Pรบrpura
            O="\e[1;33m"    # Naranja
            ;;
        "gaming")
            R="\e[38;5;197m"    # Rojo gaming
            G="\e[38;5;83m"     # Verde gaming
            Y="\e[38;5;227m"    # Amarillo gaming
            B="\e[38;5;39m"     # Azul gaming
            M="\e[38;5;207m"    # Magenta gaming
            C="\e[38;5;123m"    # Cyan gaming
            W="\e[38;5;255m"    # Blanco gaming
            P="\e[38;5;93m"     # Pรบrpura gaming
            O="\e[38;5;202m"    # Naranja gaming
            ;;
        "minimal")
            R="\e[0;31m"    # Rojo
            G="\e[0;32m"    # Verde
            Y="\e[0;33m"    # Amarillo
            B="\e[0;34m"    # Azul
            M="\e[0;35m"    # Magenta
            C="\e[0;36m"    # Cyan
            W="\e[0;37m"    # Blanco
            P="\e[0;35m"    # Pรบrpura
            O="\e[0;33m"    # Naranja
            ;;
        "cyber")
            R="\e[38;5;81m"     # Rojo cyber
            G="\e[38;5;46m"     # Verde cyber
            Y="\e[38;5;226m"    # Amarillo cyber
            B="\e[38;5;21m"     # Azul cyber
            M="\e[38;5;201m"    # Magenta cyber
            C="\e[38;5;51m"     # Cyan cyber
            W="\e[38;5;255m"    # Blanco cyber
            P="\e[38;5;129m"    # Pรบrpura cyber
            O="\e[38;5;208m"    # Naranja cyber
            ;;
        "matrix")
            R="\e[38;5;40m"     # Verde matrix
            G="\e[38;5;46m"     # Verde brillante matrix
            Y="\e[38;5;82m"     # Amarillo matrix
            B="\e[38;5;48m"     # Azul matrix
            M="\e[38;5;84m"     # Magenta matrix
            C="\e[38;5;85m"     # Cyan matrix
            W="\e[38;5;255m"    # Blanco matrix
            P="\e[38;5;120m"    # Pรบrpura matrix
            O="\e[38;5;121m"    # Naranja matrix
            ;;
    esac
    RESET="\e[0m"   # Reset
    BW="\e[1;40;37m" # Blanco sobre negro
}

# ==================================================
# SISTEMA DE AUTO-ACTUALIZACIรN OBLIGATORIA
# ==================================================

check_for_updates() {
    echo -e "${C}๐ Buscando actualizaciones...${RESET}"
    
    # Verificar si ha pasado el tiempo mรญnimo desde la รบltima verificaciรณn
    local current_time=$(date +%s)
    local last_check_time=0
    
    if [[ -f "$LAST_CHECK_FILE" ]]; then
        last_check_time=$(cat "$LAST_CHECK_FILE")
    fi
    
    local time_since_last_check=$((current_time - last_check_time))
    
    if [[ "$FORCE_CHECK" != "true" && $time_since_last_check -lt $UPDATE_CHECK_INTERVAL ]]; then
    local hours_left=$(( (UPDATE_CHECK_INTERVAL - time_since_last_check) / 3600 ))
    echo -e "${Y}โณ Prรณxima verificaciรณn en: ${hours_left}h${RESET}"
    return 0
fi

    
    # Guardar tiempo de esta verificaciรณn
    echo "$current_time" > "$LAST_CHECK_FILE"
    
    # Obtener versiรณn del script en GitHub
    echo -e "${Y}๐ก Conectando con GitHub...${RESET}"
    
    # Intento con curl
   
  # Obtener versiรณn desde version.txt (compatible con BIN)
if command -v curl &> /dev/null; then
    remote_version=$(curl -s https://raw.githubusercontent.com/TitoYTMex23/tito_vpn_bin/main/version.txt)
elif command -v wget &> /dev/null; then
    remote_version=$(wget -qO- https://raw.githubusercontent.com/TitoYTMex23/tito_vpn_bin/main/version.txt)
else
    echo -e "${R}โ No se pudo verificar actualizaciones${RESET}"
    return 1

    fi
    
    if [[ -z "$remote_version" ]]; then
        echo -e "${R}โ๏ธ  No se pudo obtener la versiรณn remota${RESET}"
        return 1
    fi
    
    echo -e "${C}๐ Versiรณn local: ${VERSION}${RESET}"
    echo -e "${C}๐ Versiรณn remota: ${remote_version}${RESET}"
    
    # Comparar versiones
    if [[ "$remote_version" != "$VERSION" ]]; then
        echo -e "${G}โจ ยกNueva versiรณn disponible!${RESET}"
        echo -e "${Y}๐ฅ Actualizando automรกticamente...${RESET}"
        return 2  # Cรณdigo para indicar que hay actualizaciรณn
    else
        echo -e "${G}โ Ya tienes la รบltima versiรณn${RESET}"
        return 0
    fi
}

force_update() {
    echo -e "${M}๐ INICIANDO ACTUALIZACIรN OBLIGATORIA${RESET}"
    echo -e "${Y}๐ฅ Descargando nueva versiรณn desde GitHub...${RESET}"
    
    # Descargar BINARIO actualizado (NO script)
    if command -v curl &> /dev/null; then
        if curl -s -o "$SCRIPT_NAME.new" "$GITHUB_RAW_URL"; then
            echo -e "${G}โ Descarga completada${RESET}"
        else
            echo -e "${R}โ Error en la descarga${RESET}"
            return 1
        fi
    elif command -v wget &> /dev/null; then
        if wget -q -O "$SCRIPT_NAME.new" "$GITHUB_RAW_URL"; then
            echo -e "${G}โ Descarga completada${RESET}"
        else
            echo -e "${R}โ Error en la descarga${RESET}"
            return 1
        fi
    else
        echo -e "${R}โ No se puede descargar (curl/wget no disponibles)${RESET}"
        return 1
    fi
    
    # Hacer ejecutable
    chmod +x "$SCRIPT_NAME.new"
    
    # Reemplazar el binario actual
    mv "$SCRIPT_NAME.new" "$SCRIPT_NAME"
    
    # Actualizar versiรณn en archivo
    echo "$VERSION" > "$VERSION_FILE"
    
    echo -e "${G}๐ Actualizaciรณn completada exitosamente${RESET}"
    echo -e "${Y}๐ Reiniciando con nueva versiรณn...${RESET}"
    
    play_sound "success"
    sleep 2
    
    # Ejecutar nueva versiรณn
    exec "$0"

}    
    
    

mandatory_update_check() {
    echo -e "${C}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
    echo -e "${C}โ${Y}               VERIFICACIรN DE ACTUALIZACIONES                 ${C}โ${RESET}"
    echo -e "${C}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
    echo ""
    
    check_for_updates
    local update_status=$?
    
    case $update_status in
        0)
            echo -e "${G}โ Sistema actualizado${RESET}"
            sleep 1
            ;;
        1)
            echo -e "${Y}โ๏ธ  No se pudo verificar actualizaciones${RESET}"
            echo -e "${C}Continuando con versiรณn actual...${RESET}"
            sleep 2
            ;;
        2)
            echo -e "${R}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
            echo -e "${R}โ${Y}           ACTUALIZACIรN OBLIGATORIA REQUERIDA               ${R}โ${RESET}"
            echo -e "${R}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
            echo ""
            echo -e "${Y}๐ข Se requiere actualizar para continuar usando TitoVPN${RESET}"
            echo -e "${C}La actualizaciรณn comenzarรก automรกticamente en 5 segundos...${RESET}"
            echo ""
            
            for i in {5..1}; do
                echo -ne "${Y}โณ Iniciando en: ${i}s${RESET}\r"
                sleep 1
            done
            echo ""
            
            force_update
            ;;
    esac
}

# ---------- EFECTOS DE SONIDO PREMIUM ----------
play_sound() {
    [[ "$SOUND_ENABLED" != "true" ]] && return
    
    local sound_type="$1"
    
    case $sound_type in
        "start") 
            printf '\a'
            sleep 0.1
            printf '\a'
            ;;
        "success")
            for i in {1..3}; do
                printf '\a'
                sleep 0.08
            done
            ;;
        "error")
            printf '\a\a\a'
            sleep 0.3
            printf '\a\a'
            ;;
        "typing")
            [[ $((RANDOM % 3)) -eq 0 ]] && printf '\a'
            ;;
        "step")
            printf '\a'
            ;;
        "menu")
            printf '\a'
            sleep 0.05
            printf '\a'
            ;;
        "connection")
            for i in {1..5}; do
                printf '\a'
                sleep 0.05
            done
            ;;
        "download")
            [[ $((RANDOM % 5)) -eq 0 ]] && printf '\a'
            ;;
        "beep")
            printf '\a'
            ;;
    esac
}

# ---------- LOGOS ASCII ANIMADOS ----------
animate_logo() {
    [[ "$ANIMATIONS_ENABLED" != "true" ]] && return
    
    local logo_type="$1"
    
    case $logo_type in
        "satellite")
            frames=(
                "   .-\"\"\"-.   "
                "  /        \\  "
                " |    โก    | "
                "  \\        /  "
                "   '-....-'   "
                
                "   .-\"\"\"-.   "
                "  /   โก   \\  "
                " |         | "
                "  \\   โก   /  "
                "   '-....-'   "
                
                "   .-\"\"\"-.   "
                "  /        \\  "
                " |    ๐    | "
                "  \\        /  "
                "   '-....-'   "
            )
            
            for i in {0..2}; do
                clear
                echo -e "${C}"
                for line in "${frames[@]:$i*5:5}"; do
                    echo "$line"
                done
                echo -e "${RESET}"
                sleep 0.3
            done
            ;;
            
        "vpn_tunnel")
            frames=(
                "${C}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
                "${C}โ${G}  >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  ${C}โ${RESET}"
                "${C}โ${B}  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  ${C}โ${RESET}"
                "${C}โ${M}  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  ${C}โ${RESET}"
                "${C}โ${Y}  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  ${C}โ${RESET}"
                "${C}โ${G}  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  ${C}โ${RESET}"
                "${C}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
                
                "${C}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
                "${C}โ${G}   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>   ${C}โ${RESET}"
                "${C}โ${B}  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  ${C}โ${RESET}"
                "${C}โ${M}  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  ${C}โ${RESET}"
                "${C}โ${Y}  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  ${C}โ${RESET}"
                "${C}โ${G}  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  ${C}โ${RESET}"
                "${C}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
                
                "${C}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
                "${C}โ${G}    >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>    ${C}โ${RESET}"
                "${C}โ${B}  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  ${C}โ${RESET}"
                "${C}โ${M}  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  ${C}โ${RESET}"
                "${C}โ${Y}  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  ${C}โ${RESET}"
                "${C}โ${G}  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  ${C}โ${RESET}"
                "${C}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
            )
            
            for frame in "${frames[@]}"; do
                clear
                echo "$frame"
                sleep 0.2
            done
            ;;
            
        "signal_waves")
            for i in {1..5}; do
                clear
                echo -e "${C}"
                echo "   โโโโโโโโโโโโโโโโโโโโโโ"
                echo "   โ   ๐ก SEรAL VPN    โ"
                echo "   โโโโโโโโโโโโโโโโโโโโโโ"
                echo ""
                
                for j in {1..7}; do
                    bars=$((i * j / 2))
                    echo -ne "   "
                    for k in $(seq 1 $bars); do
                        echo -ne "${G}โ${RESET}"
                    done
                    for k in $(seq $bars 7); do
                        echo -ne "${W}โ${RESET}"
                    done
                    echo ""
                done
                sleep 0.2
            done
            ;;
    esac
}

# ---------- SPLASH ANIMADO ----------
splash() {
    clear
    play_sound "start"
    
    # Mostrar informaciรณn de versiรณn
    echo -e "${C}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
    echo -e "${C}โ${G}               TitoVPN Free - v${VERSION}                       ${C}โ${RESET}"
    echo -e "${C}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
    echo ""
    
    if [[ "$ANIMATIONS_ENABLED" == "true" ]]; then
        animate_logo "satellite"
        sleep 0.5
        animate_logo "vpn_tunnel"
        sleep 0.5
    fi
    
    show_theme_banner
    echo ""
    
    if [[ "$ANIMATIONS_ENABLED" == "true" ]]; then
        animate_text "   Iniciando TitoVPN Free..."
        echo ""
        loading_bar "Cargando componentes"
        play_sound "success"
    else
        echo -e "${C}   Iniciando TitoVPN Free...${RESET}"
        echo -e "${Y}   Cargando componentes... โ${RESET}"
    fi
    
    sleep 1
}

# ---------- BANNERS TEMรTICOS ----------
show_theme_banner() {
    clear
    echo -e "${C}"
    
    case $THEME in
        "tech")
            cat << "EOF"
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
  
  โโโโโโโโโโ   โโโโโโโโโโ  โโโโโโ                         
   โโโโโโโโโโโ   โโโโโโโโโโโโโโโโโโโ                        
   โโโ     โโโ   โโโโโโโโโโโโโโโโโโโ                        
   โโโ     โโโ   โโโโโโโโโโโโโโโโโโโ                        
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โโโ                        
    โโโโโโโ โโโโโโโ โโโโโโโ โโโ  โโโ                        
                                                             
        CUBA VPN-CONEXIรN LIBRE por TitoMX                    
           ๐ ACCESO SIN RESTRICCIONES                       
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
EOF
            ;;
            
        "gaming")
            echo -e "${R}"
            cat << "EOF"
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ  โโ  โโโโโโโโโโโโโโโโโโโโโ โโโโโโโ โโโ   โโโ โโโโโโโ โโโโ  โโ  โ
โ  โโ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโโโ โโ  โ
โ  โโ     โโโ   โโโ   โโโ   โโโ   โโโโโโ   โโโโโโ   โโโโโโโโโโโ  โ
โ  โโ     โโโ   โโโ   โโโ   โโโ   โโโโโโ   โโโโโโ   โโโโโโโโโโโ  โ
โ  โโ     โโโ   โโโ   โโโ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โโโโ  โ
โ  โโ     โโโ   โโโ   โโโ    โโโโโโโ  โโโโโโโ  โโโโโโโ โโโ  โโโ  โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ           ๐ฎ TitoVPN GAMER - LATENCIA ULTRABAJA            โ
โ           ๐ ACELERACIรN PARA JUEGOS ONLINE                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
EOF
            ;;
            
        "matrix")
            echo -e "${G}"
            cat << "EOF"
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  01010100 01001001 01010100 01001111 01001101 01011000      โ
โ  01110110 01110000 01101110 00100000 01110101 01101100      โ
โ  01110100 01101001 01101101 01100001 01110100 01100101      โ
โ                                                            โ
โ   โโโโโโโโโโโโโโโโโโโโโ โโโโโโโ โโโ   โโโ โโโโโโโ โโโโ   โโโโ
โ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโโโ  โโโโ
โ      โโโ   โโโ   โโโ   โโโ   โโโโโโ   โโโโโโ   โโโโโโโโโ โโโโ
โ      โโโ   โโโ   โโโ   โโโ   โโโโโโ   โโโโโโ   โโโโโโโโโโโโโโ
โ      โโโ   โโโ   โโโ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โโโโโโโ
โ      โโโ   โโโ   โโโ    โโโโโโโ  โโโโโโโ  โโโโโโโ โโโ  โโโโโโ
โ                                                            โ
โ          ๐ TitoVPN MATRIX - ENTRADA AL SISTEMA           โ
โ          ๐ก Protocolo: QUIC over DNS - INDETECTABLE       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
EOF
            ;;
            
        "cyber"|"minimal")
            echo -e "${M}"
            cat << "EOF"
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                              โ
โ  โโโโโโโโโโโโโโโโโโโโโ โโโโโโโ โโโ   โโโ โโโโโโโ โโโโ   โโโ  โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโโโ  โโโ  โ
โ     โโโ   โโโ   โโโ   โโโ   โโโโโโ   โโโโโโ   โโโโโโโโโ โโโ  โ
โ     โโโ   โโโ   โโโ   โโโ   โโโโโโ   โโโโโโ   โโโโโโโโโโโโโ  โ
โ     โโโ   โโโ   โโโ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โโโโโโ  โ
โ     โโโ   โโโ   โโโ    โโโโโโโ  โโโโโโโ  โโโโโโโ โโโ  โโโโโ  โ
โ                                                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
EOF
            ;;
    esac
    
    echo -e "${C}"
    echo "           ๐ TitoVPN Free Edition v${VERSION}"
   echo -e "\e[34mTitoVPN Datos/Wifi Gratis Cuba ๐\e[0m"
    echo -e "\e[33m๐น Bot de Telegram: @InternetTitofree_bot\e[0m"
    echo -e "\e[33m๐น CANAL OFICIAL: https://t.me/titoYTMex\e[0m"
    echo -e "\e[33m๐น CHAT OFICIAL: https://t.me/titoYTMex2\e[0m"
    echo -e "\e[33m๐น FACEBOOK: https://www.facebook.com/profile.php?id=61552016896249\e[0m"
    echo -e "\e[32m๐ รnanse a todos para que siempre estรฉn informados ๐ Dios les bendiga\e[0m" 
  
  echo "           ๐ Conexiรณn Segura y Rรกpida"
    echo -e "${RESET}"
}

# ---------- ANIMACIONES ----------
animate_text() {
    [[ "$ANIMATIONS_ENABLED" != "true" ]] && {
        echo -e "${C}$1${RESET}"
        return
    }
    
    local text="$1"
    echo -ne "${C}"
    for ((i=0; i<${#text}; i++)); do
        echo -n "${text:$i:1}"
        play_sound "typing"
        sleep 0.03
    done
    echo -e "${RESET}"
}

loading_bar() {
    [[ "$ANIMATIONS_ENABLED" != "true" ]] && {
        echo -e "${Y}   $1... โ${RESET}"
        return
    }
    
    local msg="$1"
    echo -ne "${Y}   ${msg} ${C}["
    for i in {1..20}; do
        echo -ne "โ"
        play_sound "download"
        sleep 0.05
    done
    echo -e "]${G} โ${RESET}"
}

beep() { 
    play_sound "beep"
}

pause() { 
    echo -e "${Y}"
    read -p "   ๐ Presiona ENTER para continuar... " 
    echo -e "${RESET}"
}

# ---------- CABECERA MEJORADA ----------
show_header() {
    clear
    show_theme_banner
    
    echo -e "${B}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
    echo -e "${B}โ${Y}  โญ T I T O V P N   F R E E v${VERSION}   ${STATE}${B}          โ${RESET}"
    echo -e "${B}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ${RESET}"
    if [[ -f "$LAST_DNS" ]]; then
        echo -e "${B}โ${G}  ๐ DNS Activo: $(cat $LAST_DNS)${B}                         โ${RESET}"
    fi
    echo -e "${B}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
    echo ""
}

# ---------- LOG PRO ORIGINAL (MANTENIDO) ----------
log() {
    echo -e "${CYAN}[$(date '+%H:%M:%S')]${NC} $1"
}

# ==================================================
# FUNCIรN DE CONEXIรN ORIGINAL (ยกNO SE TOCร NADA!)
# ==================================================
run_slipstream() {
  local DNS="$1"

  log "${BLUE}๐ Probando DNS:${NC} ${BOLD}$DNS${NC}"

  pkill -f slipstream-client 2>/dev/null
  rm -f "$LOG_FILE"

  ./slipstream-client \
    --congestion-control=cubic \
    --tcp-listen-port=8080 \
    --resolver=${DNS}:53 \
    --domain=1.mx4.dpdns.org \
    --keep-alive-interval=120000 --gso=false \
    > "$LOG_FILE" 2>&1 &

  sleep 10

  if grep -qiE "connection ready|connection confirmed" "$LOG_FILE"; then
    log "${GREEN}โ CONEXIรN CONFIRMADA${NC} con DNS ${BOLD}$DNS${NC}"
    echo "$DNS" > "$LAST_DNS"
    return 0
  else
    log "${RED}โ No conectรณ${NC} con DNS $DNS"
    pkill -f slipstream-client
    return 1
  fi
}

# ==================================================
# LรGICA DE CONEXIรN PRINCIPAL (ยกNO SE TOCร NADA!)
# ==================================================
start_connection() {
    local DNS_SELECTED=("$@")
    STATE="๐ก Conectando"
    
    show_header
    echo -e "${B}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
    echo -e "${B}โ${Y}               INICIANDO CONEXIรN SEGURA                     ${B}โ${RESET}"
    echo -e "${B}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
    echo ""
    
    while true; do
        CONNECTED=false

        # Priorizar DNS anterior si existe (LรGICA ORIGINAL MANTENIDA)
        if [[ -f "$LAST_DNS" ]]; then
            PRIORITY_DNS=$(cat "$LAST_DNS")
            log "${YELLOW}โญ Usando DNS prioritario:${NC} $PRIORITY_DNS"
            DNS_ORDER=("$PRIORITY_DNS" "${DNS_SELECTED[@]}")
        else
            DNS_ORDER=("${DNS_SELECTED[@]}")
        fi

        for DNS in "${DNS_ORDER[@]}"; do
            echo -e "${C}   ๐ Probando DNS: ${Y}$DNS${RESET}"
            echo ""
            
            if [[ "$ANIMATIONS_ENABLED" == "true" ]]; then
                loading_bar "Verificando red"
                loading_bar "Iniciando tรบnel QUIC"
            else
                echo -e "${Y}   Verificando red...${RESET}"
                echo -e "${Y}   Iniciando tรบnel QUIC...${RESET}"
            fi
            
            echo -e "${M}   ๐ Estableciendo conexiรณn segura...${RESET}"
            echo ""

            if run_slipstream "$DNS"; then
                CONNECTED=true
                STATE="๐ข Conectado"
                
                # Efecto de conexiรณn exitosa
                play_sound "connection"
                beep
                echo -e "${G}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
                echo -e "${G}โ${BW}           โ CONEXIรN ESTABLECIDA EXITOSAMENTE            ${G}โ${RESET}"
                echo -e "${G}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
                echo ""
                echo -e "${M}   ๐ Gracias por usar TitoVPN Free${RESET}"
                echo -e "${C}   ๐ DNS activo: ${Y}$DNS${RESET}"
                echo ""
                
                if [[ "$ANIMATIONS_ENABLED" == "true" ]]; then
                    animate_logo "vpn_tunnel"
                fi
                
                # Bucle de tiempo (LรGICA ORIGINAL MANTENIDA)
                log "${GREEN}โณ SESIรN ACTIVA โ 5 MINUTOS${NC}"
                for ((i=WAIT_TIME; i>0; i-=30)); do
                    # Barra de progreso premium
                    echo -ne "${Y}   โณ Tiempo restante: ${W}${i}s ${C}"
                    
                    # Calcular progreso
                    progress=$((20 - (20 * i / WAIT_TIME)))
                    for ((j=0; j<20; j++)); do
                        if [ $j -lt $progress ]; then
                            echo -ne "โ"
                        else
                            echo -ne "โ"
                        fi
                    done
                    echo -e "${RESET}"
                    sleep 30
                done
                
                STATE="๐ด Desconectado"
                echo ""
                echo -e "${Y}   โ๏ธ  Sesiรณn finalizada - Reiniciando conexiรณn${RESET}"
                log "${MAGENTA}๐ Reiniciando conexiรณn con DNS confirmado${NC}"
                echo ""
                break
            else
                echo -e "${R}   โ Fallรณ con DNS: $DNS${RESET}"
                echo ""
            fi
        done

        if [[ "$CONNECTED" = false ]]; then
            STATE="๐ด Desconectado"
            log "${RED}๐ซ NINGรN DNS CONECTร${NC}"
            log "${YELLOW}โ ACTIVA Y DESACTIVA MODO AVIรN${NC}"
            play_sound "error"
            echo ""
            echo -e "${R}   โ Error de conexiรณn - Reintentando en 20 segundos${RESET}"
            sleep 20
        fi
    done
}

# ---------- HERRAMIENTAS PREMIUM ----------
dns_checker() { 
    show_header
    echo -e "${C}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
    echo -e "${C}โ${Y}                    INFORMACIรN DNS                           ${C}โ${RESET}"
    echo -e "${C}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
    echo ""
    if [[ -f "$LAST_DNS" ]]; then 
        echo -e "${G}   ๐ DNS ACTIVO:${W} $(cat $LAST_DNS)${RESET}"
    else 
        echo -e "${R}   โ No hay DNS activo${RESET}"
    fi
    pause
}

ip_checker() { 
    show_header
    echo -e "${C}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
    echo -e "${C}โ${Y}                     TU IP PรBLICA                           ${C}โ${RESET}"
    echo -e "${C}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
    echo ""
    
    if [[ "$ANIMATIONS_ENABLED" == "true" ]]; then
        echo -ne "${G}   ๐ก Obteniendo IP pรบblica"
        for i in {1..3}; do
            echo -ne "."
            sleep 0.3
        done
        echo ""
    fi
    
    echo -e "${W}   IP: ${Y}$(curl -s https://api.ipify.org)${RESET}"
    pause
}

host_extractor() { 
    show_header
    echo -e "${C}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
    echo -e "${C}โ${Y}                  RESOLUCIรN DE DOMINIO                      ${C}โ${RESET}"
    echo -e "${C}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
    echo ""
    read -p "   ๐ Dominio: " H
    echo ""
    echo -e "${G}   Resultado:${RESET}"
    ping -c1 "$H" | head -2
    pause
}

test_conexion() { 
    show_header
    echo -e "${C}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
    echo -e "${C}โ${Y}                   TEST DE CONEXIรN                          ${C}โ${RESET}"
    echo -e "${C}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
    echo ""
    
    if [[ "$ANIMATIONS_ENABLED" == "true" ]]; then
        echo -e "${Y}   Probando conexiรณn con Google DNS...${RESET}"
        echo ""
        loading_bar "Enviando pings"
    else
        echo -e "${Y}   Probando conexiรณn...${RESET}"
    fi
    
    if ping -c2 8.8.8.8 &> /dev/null; then
        echo -e "${G}   โ Conexiรณn establecida correctamente${RESET}"
        play_sound "success"
    else
        echo -e "${R}   โ Error de conexiรณn${RESET}"
        play_sound "error"
    fi
    pause
}

menu_tools() {
    while true; do
        show_header
        echo -e "${M}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
        echo -e "${M}โ${Y}                     HERRAMIENTAS                            ${M}โ${RESET}"
        echo -e "${M}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
        echo ""
        echo -e "${G}   1) ${W}@ DNS en uso${RESET}"
        echo -e "${G}   2) ${W}๐ก Ver IP pรบblica${RESET}"
        echo -e "${G}   3) ${W}๐ Resolver dominio${RESET}"
        echo -e "${G}   4) ${W}๐ถ Test de conexiรณn${RESET}"
        echo -e "${G}   5) ${W}โ๏ธ  Configuraciรณn Avanzada${RESET}"
        echo -e "${G}   6) ${W}๐ Verificar Actualizaciones${RESET}"
        echo -e "${G}   7) ${W}๐ Volver al menรบ principal${RESET}"
        echo ""
        echo -e "${C}   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
        read -p "   Opciรณn: " O
        
        case $O in
            1) dns_checker ;;
            2) ip_checker ;;
            3) host_extractor ;;
            4) test_conexion ;;
            5) advanced_settings ;;
            6) 
                echo ""
               FORCE_CHECK=true
mandatory_update_check
FORCE_CHECK=false

                ;;
            7) break ;;
            *) echo -e "${R}   Opciรณn invรกlida${RESET}"; sleep 1 ;;
        esac
    done
}

# ---------- INSTALADOR PREMIUM ----------
install_slipstream() {
    STATE="๐ก Instalando"
    show_header
    
    echo -e "${M}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
    echo -e "${M}โ${Y}                   INSTALACIรN PREMIUM                       ${M}โ${RESET}"
    echo -e "${M}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
    echo ""
    
    [[ -f "./slipstream-client" ]] && {
        echo -e "${G}   โ Slipstream-client ya estรก instalado${RESET}"
        pause
        return
    }
    
    echo -e "${C}[PASO 1/3] ${Y}Actualizando paquetes...${RESET}"
    pkg update -y && pkg upgrade -y
    
    echo -e "${C}[PASO 2/3] ${Y}Instalando dependencias...${RESET}"
    pkg install -y wget openssl termux-tools dos2unix brotli
    
    echo -e "${C}[PASO 3/3] ${Y}Descargando slipstream-client...${RESET}"
    
    if [[ "$ANIMATIONS_ENABLED" == "true" ]]; then
        loading_bar "Descargando"
    fi
    
    wget https://raw.githubusercontent.com/TitoYTMex23/Tito-Slipstream-Client/refs/heads/main/Tito-Slipstream-Client
    
    echo -e "${G}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
    echo -e "${G}โ${BW}          โ INSTALACIรN COMPLETADA EXITOSAMENTE              ${G}โ${RESET}"
    echo -e "${G}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
    
    if [[ "$ANIMATIONS_ENABLED" == "true" ]]; then
        animate_logo "signal_waves"
        play_sound "success"
        play_sound "success"
    fi
    
    pause
    STATE="๐ด Desconectado"
}

# ---------- DESINSTALADOR ----------
uninstall_slipstream() {
    STATE="๐ก Desinstalando"
    show_header
    
    echo -e "${R}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
    echo -e "${R}โ${Y}                   ADVERTENCIA                               ${R}โ${RESET}"
    echo -e "${R}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
    echo ""
    echo -e "${Y}   ยฟEstรกs seguro de desinstalar TitoVPN?${RESET}"
    echo ""
    read -p "   [s/N]: " respuesta
    
    if [[ "$respuesta" =~ ^[Ss]$ ]]; then
        pkill -f slipstream-client 2>/dev/null
        rm -f slipstream-client "$LOG_FILE" "$VERSION_FILE" "$LAST_CHECK_FILE"
        
        echo ""
        echo -e "${G}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
        echo -e "${G}โ${BW}          ๐๏ธ  DESINSTALACIรN COMPLETADA                    ${G}โ${RESET}"
        echo -e "${G}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
        play_sound "success"
    else
        echo ""
        animate_text "   Operaciรณn cancelada"
    fi
    
    pause
    STATE="๐ด Desconectado"
}

# ---------- CONFIGURACIรN AVANZADA ----------
advanced_settings() {
    while true; do
        show_header
        
        echo -e "${C}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
        echo -e "${C}โ${Y}           CONFIGURACIรN AVANZADA PREMIUM                   ${C}โ${RESET}"
        echo -e "${C}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ${RESET}"
        echo -e "${C}โ${W}  Tema actual: ${THEME}${C}                                   โ${RESET}"
        echo -e "${C}โ${W}  Sonidos: ${SOUND_ENABLED} โข Animaciones: ${ANIMATIONS_ENABLED}${C} โ${RESET}"
        echo -e "${C}โ${W}  Ayuda: ${HELP_ENABLED}${C}                                    โ${RESET}"
        echo -e "${C}โ${W}  Versiรณn: ${VERSION}${C}                                      โ${RESET}"
        echo -e "${C}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
        echo ""
        
        echo -e "${G}1) ${W}๐จ Cambiar tema visual${RESET}"
        echo -e "${G}2) ${W}๐ Activar/Desactivar sonidos${RESET}"
        echo -e "${G}3) ${W}๐ฌ Activar/Desactivar animaciones${RESET}"
        echo -e "${G}4) ${W}๐ก Activar/Desactivar ayuda${RESET}"
        echo -e "${G}5) ${W}๐ Probar todos los efectos${RESET}"
        echo -e "${G}6) ${W}๐ฅ Forzar actualizaciรณn ahora${RESET}"
        echo -e "${G}7) ${W}๐ Volver${RESET}"
        echo ""
        
        read -p "Selecciona una opciรณn: " opt
        
        case $opt in
            1)
                echo ""
                echo -e "${Y}Selecciona tema:${RESET}"
                echo -e "1) ${C}Tecnolรณgico${RESET}"
                echo -e "2) ${R}Gaming${RESET}"
                echo -e "3) ${W}Minimalista${RESET}"
                echo -e "4) ${B}Cyber${RESET}"
                echo -e "5) ${G}Matrix${RESET}"
                read -p "Opciรณn: " theme_opt
                
                case $theme_opt in
                    1) THEME="tech" ;;
                    2) THEME="gaming" ;;
                    3) THEME="minimal" ;;
                    4) THEME="cyber" ;;
                    5) THEME="matrix" ;;
                esac
                load_colors
                echo -e "${G}Tema cambiado a: ${THEME}${RESET}"
                play_sound "success"
                sleep 1
                ;;
                
            2)
                if [[ "$SOUND_ENABLED" == "true" ]]; then
                    SOUND_ENABLED="false"
                    echo -e "${Y}Sonidos desactivados${RESET}"
                else
                    SOUND_ENABLED="true"
                    echo -e "${G}Sonidos activados${RESET}"
                    play_sound "success"
                fi
                sleep 1
                ;;
                
            3)
                if [[ "$ANIMATIONS_ENABLED" == "true" ]]; then
                    ANIMATIONS_ENABLED="false"
                    echo -e "${Y}Animaciones desactivadas${RESET}"
                else
                    ANIMATIONS_ENABLED="true"
                    echo -e "${G}Animaciones activadas${RESET}"
                fi
                sleep 1
                ;;
                
            4)
                if [[ "$HELP_ENABLED" == "true" ]]; then
                    HELP_ENABLED="false"
                    echo -e "${Y}Ayuda desactivada${RESET}"
                else
                    HELP_ENABLED="true"
                    echo -e "${G}Ayuda activada${RESET}"
                fi
                sleep 1
                ;;
                
            5)
                echo ""
                echo -e "${Y}Probando todos los efectos...${RESET}"
                echo ""
                
                if [[ "$ANIMATIONS_ENABLED" == "true" ]]; then
                    animate_logo "satellite"
                    sleep 0.5
                    animate_logo "vpn_tunnel"
                fi
                
                if [[ "$SOUND_ENABLED" == "true" ]]; then
                    play_sound "start"
                    play_sound "success"
                    play_sound "connection"
                fi
                
                echo -e "${G}โ Todos los efectos probados correctamente${RESET}"
                read -p "Presiona ENTER para continuar... "
                ;;
                
            6)
                echo ""
                echo -e "${Y}Forzando actualizaciรณn...${RESET}"
                force_update
                ;;
                
            7)
                break
                ;;
            *)
                echo -e "${R}   Opciรณn invรกlida${RESET}"
                sleep 1
                ;;
        esac
    done
}

# ---------- MENร PRINCIPAL ----------
main_menu() {
    # Cargar colores
    load_colors
    
    # Verificar actualizaciones OBLIGATORIAS al inicio
    mandatory_update_check
    
    # Splash screen
    splash
    
    while true; do
        show_header
        
        echo -e "${C}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
        echo -e "${C}โ${Y}                     MENร PRINCIPAL                           ${C}โ${RESET}"
        echo -e "${C}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
        echo ""
        echo -e "${G}   ๐ฑ 1) ${W}Conectar en Datos Mรณviles${RESET}"
        echo -e "${G}   ๐ถ 2) ${W}Conectar en WiFi${RESET}"
        echo -e "${G}   ๐งฐ 3) ${W}Herramientas de Red${RESET}"
        echo -e "${G}   ๐๏ธ  4) ${W}Instalar Slipstream-client${RESET}"
        echo -e "${G}   โ๏ธ  5) ${W}Configuraciรณn Avanzada${RESET}"
        echo -e "${G}   ๐๏ธ  6) ${W}Desinstalar todo${RESET}"
        echo -e "${G}   โจ๏ธ  7) ${W}Instalar comando 'tito'${RESET}"
        echo -e "${R}   โ  0) ${W}Salir${RESET}"
        echo ""
        echo -e "${M}   Tema: ${THEME} โข Sonido: ${SOUND_ENABLED} โข Anim: ${ANIMATIONS_ENABLED}${RESET}"
        echo -e "${C}   Versiรณn: ${VERSION}${RESET}"
        echo -e "${C}   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"
        echo -ne "${Y}   Selecciona una opciรณn: ${W}"
        
        read -n 1 OP
        echo ""
        
        case $OP in
            1) 
                echo ""
                animate_text "   Modo: Datos Mรณviles ๐ฑ"
                start_connection "${DNS_MOBILE[@]}"
                ;;
            2) 
                echo ""
                animate_text "   Modo: WiFi ๐ถ"
                start_connection "${DNS_WIFI[@]}"
                ;;
            3) menu_tools ;;
            4) install_slipstream ;;
            5) advanced_settings ;;
            6) uninstall_slipstream ;;
            7) 
                echo ""
                install_tito_command_simple
                ;;
            0) 
                echo ""
                animate_text "   ยกGracias por usar TitoVPN Free! ๐"
                play_sound "success"
                sleep 1
                clear
                exit 0 
                ;;
            *) 
                echo ""
                echo -e "${R}   โ Opciรณn invรกlida. Intenta nuevamente.${RESET}"
                play_sound "error"
                sleep 1
                ;;
        esac
    done
}

# ---------- INSTALADOR SIMPLE DE COMANDO 'tito' ----------
install_tito_command_simple() {
    echo -e "${C}Instalando comando 'tito'...${RESET}"
    
    # Crear archivo ejecutable en /usr/bin
    cat > /data/data/com.termux/files/usr/bin/tito << 'EOF'
#!/data/data/com.termux/files/usr/bin/bash
cd /data/data/com.termux/files/home
./tito_vpn
EOF
    
    # Dar permisos de ejecuciรณn
    chmod +x /data/data/com.termux/files/usr/bin/tito
    
    # Agregar alias al .bashrc
    echo "alias tito='/data/data/com.termux/files/usr/bin/tito'" >> ~/.bashrc
    
    echo -e "${G}โ Comando 'tito' instalado correctamente${RESET}"
    echo -e "${Y}Ahora puedes escribir 'tito' para ejecutar el script${RESET}"
    echo -e "${C}Cierra y abre Termux nuevamente o ejecuta: source ~/.bashrc${RESET}"
    pause
}


# ---------- EJECUCIรN ----------

STATE="๐ด Desconectado"
main_menu
